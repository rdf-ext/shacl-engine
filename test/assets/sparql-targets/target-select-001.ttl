@prefix ex: <http://example.org/>.
@prefix mf: <http://www.w3.org/2001/sw/DataAccess/tests/test-manifest#>.
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>.
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>.
@prefix sh: <http://www.w3.org/ns/shacl#>.
@prefix sht: <http://www.w3.org/ns/shacl-test#>.
@prefix xsd: <http://www.w3.org/2001/XMLSchema#>.

# Data
ex:ValidResource
  ex:name "Valid Name" .

ex:InvalidResource
  ex:name 123 .

ex:OtherResource
  ex:other "Not targeted" .

# Shape with SPARQL target
ex:NameShape a sh:NodeShape;
  sh:target [
    a sh:SPARQLTarget;
    sh:select """
      SELECT ?this
      WHERE {
        ?this <http://example.org/name> ?name .
      }
    """
  ];
  sh:property ex:NamePropertyShape.

ex:NamePropertyShape a sh:PropertyShape;
  sh:path ex:name;
  sh:datatype xsd:string.

# Manifest
<> a mf:Manifest;
  mf:entries (<target-select-001>).

<target-select-001> a sht:Validate;
  rdfs:label "Test of sh:target with sh:select 001";
  mf:action [
    sht:dataGraph <>;
    sht:shapesGraph <>
  ];
  mf:result [
    a sh:ValidationReport;
    sh:conforms false;
    sh:result [
      a sh:ValidationResult;
      sh:focusNode ex:InvalidResource;
      sh:resultPath ex:name;
      sh:resultSeverity sh:Violation;
      sh:sourceConstraintComponent sh:DatatypeConstraintComponent;
      sh:sourceShape ex:NamePropertyShape;
      sh:value 123
    ]
  ].
